{
  "version": 3,
  "file": "util.js",
  "sourceRoot": "",
  "sources": [
    "../src/util.ts"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "import { execFile, spawn as _spawn } from \"child_process\"\nimport { Promise as BluebirdPromise } from \"bluebird\"\nimport readPackageJsonAsync = require(\"read-package-json\")\nimport * as os from \"os\"\nimport * as path from \"path\"\n\nexport const log = console.log\n\nexport const DEFAULT_APP_DIR_NAME = \"app\"\n\nexport const commonArgs: any[] = [{\n  name: \"appDir\",\n  type: String,\n  description: \"Relative (to the working directory) path to the folder containing the application package.json. Working directory or app/ by default.\"\n}]\n\nexport const readPackageJson = BluebirdPromise.promisify(readPackageJsonAsync)\n\nexport function installDependencies(appDir: string, electronVersion: string, arch: string = process.arch, command: string = \"install\"): BluebirdPromise<any> {\n  log(\"Installing app dependencies for arch %s to %s\", arch, appDir)\n  const gypHome = path.join(os.homedir(), \".electron-gyp\")\n  const env = Object.assign({}, process.env, {\n    npm_config_disturl: \"https://atom.io/download/atom-shell\",\n    npm_config_target: electronVersion,\n    npm_config_runtime: \"electron\",\n    npm_config_arch: arch,\n    HOME: gypHome,\n    USERPROFILE: gypHome,\n  })\n\n  let npmExecPath = process.env.npm_execpath || process.env.NPM_CLI_JS\n  const npmExecArgs = [command, \"--production\"]\n  if (npmExecPath == null) {\n    npmExecPath = \"npm\"\n  }\n  else {\n    npmExecArgs.unshift(npmExecPath)\n    npmExecPath = process.env.npm_node_execpath || process.env.NODE_EXE || \"node\"\n  }\n\n  return spawn(npmExecPath, npmExecArgs, {\n    cwd: appDir,\n    stdio: \"inherit\",\n    env: env\n  })\n}\n\nexport interface BaseExecOptions {\n  cwd?: string\n  env?: any\n  stdio?: any\n}\n\nexport interface ExecOptions extends BaseExecOptions {\n  customFds?: any\n  encoding?: string\n  timeout?: number\n  maxBuffer?: number\n  killSignal?: string\n}\n\nexport interface SpawnOptions extends BaseExecOptions {\n  custom?: any\n  detached?: boolean\n}\n\nexport function exec(file: string, args?: string[], options?: ExecOptions): BluebirdPromise<Buffer[]> {\n  return new BluebirdPromise<Buffer[]>((resolve, reject) => {\n    execFile(file, args, options, function (error, stdout, stderr) {\n      if (error == null) {\n        resolve([stdout, stderr])\n      }\n      else {\n        if (stdout.length !== 0) {\n          console.error(stdout.toString())\n        }\n        if (stderr.length !== 0) {\n          console.error(stderr.toString())\n        }\n        reject(error)\n      }\n    })\n  })\n}\n\nexport function spawn(command: string, args?: string[], options?: SpawnOptions): BluebirdPromise<any> {\n  return new BluebirdPromise<any>((resolve, reject) => {\n    const p = _spawn(command, args, options)\n    p.on(\"close\", (code: number) => code === 0 ? resolve() : reject(new Error(command + \" exited with code \" + code)))\n  })\n}\n\nexport function getElectronVersion(packageData: any, filePath: string): string {\n  const devDependencies = packageData.devDependencies\n  let electronPrebuiltDep = devDependencies == null ? null : devDependencies[\"electron-prebuilt\"]\n  if (electronPrebuiltDep == null) {\n    const dependencies = packageData.dependencies\n    electronPrebuiltDep = dependencies == null ? null : dependencies[\"electron-prebuilt\"]\n  }\n\n  if (electronPrebuiltDep == null) {\n    throw new Error(\"Cannot find electron-prebuilt dependency to get electron version in the '\" + filePath + \"'\")\n  }\n  return electronPrebuiltDep.substring(1)\n}"
  ]
}
